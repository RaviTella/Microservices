apiVersion: 2018-10-01
location: eastus
name: readingListAppContainerGroup
properties:
  containers:
  - name: aci-mysql-db
    properties:
      image: mysql/mysql-server:latest
      resources:
        requests:
          cpu: 2
          memoryInGb: 2.5
      environmentVariables:
        - name: 'MYSQL_ROOT_PASSWORD'
          value: 'password'
        - name: 'MYSQL_DATABASE'
          value: 'readinglist'  
        - name: 'MYSQL_USER'
          value: 'user'
        - name: 'MYSQL_PASSWORD'
          value: 'password'        
      ports:
      - port: 3306  
  - name: aci-recommendation-api
    properties:
      image: ravitella/docker-springboot-recommendationservice:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      ports:
      - port: 8080
  - name: aci-readinglist-webapp
    properties:
      image: ravitella/readinglist-springboot-mysql:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      environmentVariables:
        - name: 'spring_datasource_url'
          value: 'jdbc:mysql://localhost:3306/readinglist?useSSL=false&allowPublicKeyRetrieval=true'
        - name: 'spring_datasource_username'
          value: 'user'  
        - name: 'spring_datasource_password'
          value: 'password'
        - name: 'externalAPI_recommendationAPIURL'
          value: 'http://localhost:8080/recommendations'
      ports:
      - port: 7070
  osType: Linux
  ipAddress:
    type: Public
    ports:
    - protocol: tcp
      port: '7070'
tags: null
type: Microsoft.ContainerInstance/containerGroups